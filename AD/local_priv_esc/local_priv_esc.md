# Local Privilege Escalation

* various ways for local priv esc on windows
  * missing patches
  * automated deployment and autologon passwords in clear text
  * AlwaysInstallElevated (any user can run MSI as SYSTEM)
  * misconfigured services
  * dll highjacking

* external tools
  * Powerup - https://github.com/PowerShellMafia/PowerSploit/tree/master/Privesc
  * BeRoot - https://github.com/AlessandroZ/BeRoot
  * Privesc - https://github.com/enjoiz/Privesc


#### services issues using PowerUp
* services with unquoted paths and a space in their name
```powershell
Get-ServiceUnquoted -Verbose

Get-WmiObject -Class win32_service | select pathname ## search for services with a space in its path and unquoted. /path/to vuln/dir/ -> /path/to.exe
```

* services where the current user can write to its binary path or change arguments to the binary
```powershell
Get-ModifiableServiceFile -Verbose
```

* services whose config can be modified by current user
```powershell
Get-ModifiableService -Verbose
```

#### run all checks:

* PowerUp
```powershell
Invoke_AllChecks
```

* BeRoot is an exe
```powershell
.\beRoot.exe
```

* privesc
```powershell
Invoke-PrivEsc
```

note: if anything reports a path where your .exe must be dropped in C:\, then its a false positive. If you can write to C:\ then you already have admin privs.
example C:\Program Files (x86)\some\software\goes\here.exe. The exe will then have to be C:\Program.exe  which is not possible without admin rights.






















