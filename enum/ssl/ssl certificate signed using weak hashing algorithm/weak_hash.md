```bash
apb@stratios:~/$ cat ips | awk '{print "echo IP: "$1" PORT: "$2 "; proxychains4 timeout 10 sslscan --no-ciphersuites --check-certificate --no-fallback --no-renegotiation --no-compression --no-heartbleed \\";if ($2 == 21) print "--starttls-ftp "$1":"$2; if ($2 == 25) print "--starttls-smtp "$1":"$2; if ($2 == 110) print "--starttls-pop3 "$1":"$2; if ($2 == 143) print "--starttls-imap "$1":"$2; if ($2 == 465) print "--starttls-smtp "$1":"$2; if ($2 == 993) print "--starttls-imap "$1":"$2; if ($2 == 995) print "--starttls-pop3 "$1":"$2; if ($2 == 3389) print "--rdp "$1":"$2; else print $1":"$2}' | sh 2>&1 | tee final
```

```bash
apb@stratios:~/$ cat ips | awk '{print "echo IP: "$1" PORT: "$2 ";  sslscan --no-heartbleed --no-fallback --no-renegotiation --no-compression --show-certificate "$1":"$2}' | sh 2>&1 | tee final

apb@stratios:~/$ cat final| grep "IP:\|Signature Algorithm"
IP:  PORT: 443
Signature Algorithm: md5WithRSAEncryption
IP:  PORT: 1311
Signature Algorithm: sha1WithRSAEncryption
IP:  PORT: 1311
Signature Algorithm: sha1WithRSAEncryption
IP:  PORT: 1311
Signature Algorithm: sha1WithRSAEncryption
IP:  PORT: 33890
Signature Algorithm: sha1WithRSAEncryption
IP:  PORT: 55833
```

```bash
apb@stratios:~$ proxychains4 openssl s_client -showcerts -connect IP:3389 | awk 'BEGIN{p="openssl x509 -noout -text"} {print |p} /-----END/{close(p)}' | grep "Signature Algorithm"
```

```bash
apb@stratios:~$ proxychains4 sslscan --no-heartbleed --show-certificate IP:3389 | grep "Signature"
Signature Algorithm: sha256WithRSAEncryption
```

```bash
## rpd only
cat iplist | awk '{print "echo IP: "$1" PORT: "$2"; proxychains4 sslscan --starttls-rdp --no-ciphersuites --no-fallback --no-renegotiation --no-heartbleed --no-compression " $1":"$2}' | sh 2>&1 | tee final
```

```bash
apb@stratios:~/$ proxychains /opt/nessus/bin/nasl -M -t IP -p 1433  /opt/nessus/lib/nessus/plugins/ssl_weak_hash.nasl | grep "Signature Algorithm"
```

```bash
apb@stratios:~$ proxychains4 openssl s_client -connect IP:443 | openssl x509 -noout -text -certopt no_signame | grep "Signature Algorithm"
    Signature Algorithm: sha1WithRSAEncryption

apb@stratios:~$  proxychains4 openssl s_client -connect IP:443 | openssl x509 -noout -text -certopt no_signame | grep "Signature Algorithm"
    Signature Algorithm: sha1WithRSAEncryption
```
