```bash
apb@stratios:~/$ proxychains ./testssl.sh --starttls smtp IP:25
apb@stratios:~/$ proxychains ./testssl.sh IP:443
```

```bash
apb@stratios:~$ sslscan --no-heartbleed IP:10443
```

```bash
cat ips | awk '{print "echo IP: "$1" PORT: "$2 "; proxychains4 timeout 10 sslscan --no-fallback --no-compression --no-heartbleed \\";if ($2 == 21) print "--starttls-ftp "$1":"$2; if ($2 == 25) print "--starttls-smtp "$1":"$2; if ($2 == 110) print "--starttls-pop3 "$1":"$2; if ($2 == 143) print "--starttls-imap "$1":"$2; if ($2 == 465) print "--starttls-smtp "$1":"$2; if ($2 == 995) print "--starttls-pop3 "$1":"$2; if ($2 == 3389) print "--rdp "$1":"$2; else print $1":"$2}' | sh 2>&1 | tee final	
cat final | grep "IP:\|PORT:\|112 bits\|RC4\|DES"
cat final | grep "IP:\|RC4\|SSLv\|56\|ADH\|DHE\|RSA\|512"
cat final | grep "IP:\|PORT:\|112 bits\|RC4\|DES\|SSLv\|DHE"
cat final | grep "IP:\|SSLv\|RC4\|112\| 56\|ERROR\|CBC\|A.."

IP:  3389
Preferred TLSv1.2  256 bits  ECDHE-RSA-AES256-SHA384       Curve P-256 DHE 256
Accepted  TLSv1.2  128 bits  ECDHE-RSA-AES128-SHA256       Curve P-256 DHE 256
Accepted  TLSv1.2  256 bits  ECDHE-RSA-AES256-SHA          Curve P-256 DHE 256
Accepted  TLSv1.2  128 bits  ECDHE-RSA-AES128-SHA          Curve P-256 DHE 256
Accepted  TLSv1.2  256 bits  DHE-RSA-AES256-GCM-SHA384     DHE 1024 bits
Accepted  TLSv1.2  128 bits  DHE-RSA-AES128-GCM-SHA256     DHE 1024 bits
Accepted  TLSv1.2  256 bits  DHE-RSA-AES256-SHA            DHE 1024 bits
Accepted  TLSv1.2  128 bits  DHE-RSA-AES128-SHA            DHE 1024 bits
```

```bash
apb@stratios:~/$ cat ips | awk '{print "echo IP: "$1" PORT: "$2 "; proxychains4 nmap -sV --script ssl-enum-ciphers -p "$2" -Pn "$1}' | sh 2>&1 | tee final
andriesb@stratios:~$  cat final | grep "IP:\|RC4\|SSLv\|56\|ADH\|DHE\|RSA\|512"
IP:  PORT: 1433
|   SSLv3:
|       TLS_RSA_WITH_RC4_128_MD5 (rsa 1024) - D
|       TLS_RSA_WITH_RC4_128_SHA (rsa 1024) - D
|       TLS_RSA_WITH_3DES_EDE_CBC_SHA (rsa 1024) - D
|       TLS_RSA_WITH_DES_CBC_SHA (rsa 1024) - D
|       TLS_RSA_EXPORT1024_WITH_RC4_56_SHA - D
|       TLS_RSA_EXPORT1024_WITH_DES_CBC_SHA - D
|       TLS_RSA_EXPORT_WITH_RC4_40_MD5 - E
|       TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5 - E
|       Broken cipher RC4 is deprecated by RFC 7465
|       CBC-mode cipher in SSLv3 (CVE-2014-3566)
|       TLS_RSA_WITH_RC4_128_MD5 (rsa 1024) - D
|       TLS_RSA_WITH_RC4_128_SHA (rsa 1024) - D
|       TLS_RSA_WITH_3DES_EDE_CBC_SHA (rsa 1024) - D
|       TLS_RSA_WITH_DES_CBC_SHA (rsa 1024) - D
|       TLS_RSA_EXPORT1024_WITH_RC4_56_SHA - D
|       TLS_RSA_EXPORT1024_WITH_DES_CBC_SHA - D
|       TLS_RSA_EXPORT_WITH_RC4_40_MD5 - E
|       TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5 - E
|       Broken cipher RC4 is deprecated by RFC 7465
```

```bash
# single scan - /opt/nessus/bin/nasl -M -t IP -p 49156 /opt/nessus/lib/nessus/plugins/ssl_supported_ciphers.nasl
# multiple scans - cat ips | awk '{print "echo IP: "$2" PORT: "$4"; /opt/nessus/bin/nasl -M -t " $2" -p "$4" /opt/nessus/lib/nessus/plugins/ssl_cert_expiry.nasl 2> /dev/null"}' | sh 2>&1 | tee final

[apb@sigh ~]$  cat final | grep "IP:\|SSLv\|Signature Algorithm:"

IP:  PORT: 1433
Signature Algorithm: SHA-1 With RSA Encryption
This port supports SSLv3/TLSv1.0.

IP:  PORT: 1433
Signature Algorithm: SHA-256 With RSA Encryption
Signature Algorithm: SHA-1 With RSA Encryption
This port supports SSLv3/TLSv1.0.

IP:  PORT: 5061
Signature Algorithm: SHA-1 With RSA Encryption
```

```bash
proxychains sslscan --no-fallback --no-renegotiation --no-compression --no-heartbleed IP 2>&1 | grep "SSLv\|RC4\|112\| 56\|ERROR"

apb@stratios:~/$ cat final |  grep "IP:\|SSLv\|RC4\|112\|DES\|ADH"
```
